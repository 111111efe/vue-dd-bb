webpackJsonp([1],{0:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return l.default.Promise(function(e,t){s.default.get(E.default.API_HOST+"/auth/getConfig",{params:{corpid:getParamByName("corpid")||"ding1b56d2f4ba72e91635c2f4657eb6378f",appid:getParamByName("appid")||"2545",suitekey:getParamByName("suiteKey")||"suiteiyfdj0dfixywzqwg",paramUrl:document.URL},timeout:2e3}).then(function(n){if(200==n.status&&200==n.data.code){var o=n.data.result,i={agentId:o.agentId,corpId:o.corpId,timeStamp:o.timeStamp,nonceStr:o.nonceStr,signature:o.signature,type:0,jsApiList:["runtime.info","runtime.permission.requestAuthCode","runtime.permission.requestOperateAuthCode","biz.alipay.pay","biz.contact.choose","biz.contact.complexChoose","biz.contact.complexPicker","biz.contact.createGroup","biz.customContact.choose","biz.customContact.multipleChoose","biz.ding.post","biz.map.locate","biz.map.view","biz.util.openLink","biz.util.open","biz.util.share","biz.util.ut","biz.util.uploadImage","biz.util.previewImage","biz.util.datepicker","biz.util.timepicker","biz.util.datetimepicker","biz.util.chosen","biz.util.encrypt","biz.util.decrypt","biz.chat.pickConversation","biz.telephone.call","biz.navigation.setLeft","biz.navigation.setTitle","biz.navigation.setIcon","biz.navigation.close","biz.navigation.setRight","biz.navigation.setMenu","biz.user.get","ui.progressBar.setColors","device.base.getInterface","device.connection.getNetworkType","device.launcher.checkInstalledApps","device.launcher.launchApp","device.notification.confirm","device.notification.alert","device.notification.prompt","device.notification.showPreloader","device.notification.hidePreloader","device.notification.toast","device.notification.actionSheet","device.notification.modal","device.geolocation.get"]};e(i)}else t({errCode:-2,msg:"接口请求失败"})}).catch(function(e){t({errCode:-2,msg:"接口请求失败"})})})}function a(){return l.default.Promise(function(e,t){var n=setTimeout(function(){t({errCode:-1,msg:"dd.ready初始化超时"})},2e3);N.ready(function(){console.log("初始化钉钉"),clearTimeout(n),N.biz.navigation.setLeft({show:!0,control:!0,showIcon:!0,text:"返回",onSuccess:function(e){console.log("点击了返回按钮"),window.history.back()},onFail:function(e){}}),N.runtime.info({onSuccess:function(e){window.ability=parseInt(e.ability.replace(/\./g,"")),console.log("容器版本为"+window.ability)},onFail:function(e){}}),e(!0)}),N.error(function(e){clearTimeout(n),console.error("dd error: "+JSON.stringify(e)),t({errCode:-1,msg:"dd.error配置信息不对"})})})}function c(){return l.default.Promise(function(e,t){var o;g.default.use(b.default),g.default.use(D.default),g.default.use(P.default);var i=new b.default({transitionOnLoad:!1});i.map((o={},r(o,E.default.BASE_PATH,{component:function(e){n.e(2,function(){var t=n(50).default;e(t)})},subRoutes:{"/":{component:function(e){n.e(3,function(){var t=n(56).default;e(t)})}},"/member":{component:function(e){n.e(4,function(){var t=n(66).default;e(t)})}}}}),r(o,E.default.BASE_PATH+"/user/sign_in",{component:function(e){n.e(5,function(){var t=n(74).default;e(t)})}}),r(o,E.default.BASE_PATH+"/user/bind",{component:function(e){n.e(6,function(){var t=n(78).default;e(t)})}}),o)),i.redirect({"*":E.default.BASE_PATH});var u=window.sessionStorage;u.clear();var a=1*u.getItem("count")||0;u.setItem("/",0),i.beforeEach(function(e){var t=e.to,n=e.from,o=e.next,i=u.getItem(t.path),r=u.getItem(n.path);i?i>r||!r?z("UPDATE_DIRECTION","forward"):z("UPDATE_DIRECTION","reverse"):(++a,u.setItem("count",a),"/"!==t.path&&u.setItem(t.path,a),z("UPDATE_DIRECTION","forward")),z("UPDATE_LOADING",!0),setTimeout(function(){try{N.biz.navigation.setRight({show:!1})}catch(e){console.error(e)}o()},10)}),i.afterEach(function(){z("UPDATE_LOADING",!1)}),(0,S.sync)(y.default,i),i.start(T.default,"#app"),_.default.attach(document.body),e()})}var d=n(1),l=i(d),f=n(5),s=i(f),p=n(31),g=i(p),m=n(32),b=i(m);n(40);var h=n(35),v=o(h),S=n(34),C=n(41),y=i(C),I=n(36),_=i(I),O=n(30),E=i(O),w=n(44),D=i(w),R=n(38),P=i(R),A=n(45),T=i(A);window.getParamByName=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null};var N=window.dd,z=y.default.commit||y.default.dispatch;console.log("dev"),g.default.config.debug=!0,g.default.config.devtools=!0,g.default.component("alert",v.Alert),g.default.component("loading",v.Loading),g.default.component("group",v.Group),g.default.component("x-input",v.XInput),g.default.component("x-button",v.XButton);var U=null;u().then(function(e){U=e,N.config(U)}).catch(function(e){alert(JSON.stringify(e))}).finally(function(){a().then(c).then(function(){document.querySelector("#init-loading").remove(),console.log("init vue 完成"),setTimeout(function(){null!=U?z("DDCONFIG_SUCCESS",U):z("DDCONFIG_ERROR",!1)},300)})})},40:function(e,t){},41:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(31),r=o(i),u=n(33),a=o(u),c=n(42),d=o(c);r.default.use(a.default),t.default=new a.default.Store({modules:{app:d.default}})},42:function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(43),u={isLoading:!1,direction:"forward",ddConfig:null,ddConfigStatus:null,code:null,user:null},a=(i={},o(i,r.UPDATE_LOADING,function(e,t){e.isLoading=t}),o(i,r.UPDATE_DIRECTION,function(e,t){e.direction=t}),o(i,r.DDCONFIG_SUCCESS,function(e,t){e.ddConfig=t,e.ddConfigStatus=!0}),o(i,r.DDCONFIG_ERROR,function(e,t){e.ddConfig=null,e.ddConfigStatus=!1}),o(i,r.UPDATE_CODE,function(e,t){e.code=t}),o(i,r.LOGIN_SUCCESS,function(e,t){e.user=t}),o(i,r.LOGIN_ERROR,function(e,t){e.user=!1}),i);t.default={state:u,mutations:a}},43:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UPDATE_LOADING="UPDATE_LOADING",t.UPDATE_DIRECTION="UPDATE_DIRECTION",t.DDCONFIG_SUCCESS="DDCONFIG_SUCCESS",t.DDCONFIG_ERROR="DDCONFIG_ERROR",t.UPDATE_CODE="UPDATE_CODE",t.LOGIN_SUCCESS="LOGIN_SUCCESS",t.LOGIN_ERROR="LOGIN_ERROR"},44:function(e,t,n){(function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(30),r=t(i),u={};u.install=function(e,t){e.cookie=function(e,t,n){var o,i,r,u;return arguments.length>1&&"[object Object]"!==String(t)?(n=$.extend({},n),null!==t&&void 0!==t||(n.expires=-1),"number"==typeof n.expires&&(o=24*n.expires*60*60*1e3,i=n.expires=new Date,i.setTime(i.getTime()+o)),t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:t,n.expires?"; expires="+n.expires.toUTCString():"","; path=/",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")):(n=t||{},u=n.raw?function(e){return e}:decodeURIComponent,(r=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?u(r[1]):null)},e.prototype.base_path=r.default.BASE_PATH,e.prototype.localStorage={getItem:function(e){if("object"===("undefined"==typeof localStorage?"undefined":o(localStorage)))try{return JSON.parse(localStorage.getItem(e))}catch(e){alert("请关闭[无痕浏览]模式后再试!")}},setItem:function(e,t){if("object"===("undefined"==typeof localStorage?"undefined":o(localStorage)))try{return localStorage.setItem(e,JSON.stringify(t))}catch(e){alert("请关闭[无痕浏览]模式后再试!")}},removeItem:function(e){if("object"===("undefined"==typeof localStorage?"undefined":o(localStorage)))try{return localStorage.removeItem(e)}catch(e){alert("请关闭[无痕浏览]模式后再试!")}},getUseSize:function(){if("object"===("undefined"==typeof localStorage?"undefined":o(localStorage)))try{return JSON.stringify(localStorage).length}catch(e){alert("请关闭[无痕浏览]模式后再试!")}}},Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}},function(t){"object"===o(e)&&"object"===o(e.exports)?e.exports=t:window.bb?window.bb.bbPlugin=t:window.bb={bbPlugin:t}}(u)}).call(t,n(39)(e))},45:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(31),r=o(i),u=n(46),a=o(u),c=n(47),d=o(c);n(48);var l=n(41),f=o(l),s=n(49),p=r.default.extend({template:a.default,store:f.default,vuex:{getters:{route:function(e){return e.route},isLoading:function(e){return e.app.isLoading},direction:function(e){return e.app.direction},ddConfig:function(e){return e.app.ddConfig},ddConfigStatus:function(e){return e.app.ddConfigStatus},code:function(e){return e.app.code},userInfo:function(e){return e.app.user}},actions:{getRequestAuthCode:s.getRequestAuthCode}},watch:{ddConfigStatus:function(e,t){e===!0&&this.getRequestAuthCode(this.ddConfig.corpId)},userInfo:function(e,t){e&&""==e.mobile&&this.$router.go(this.base_path+"/user/bind")}},ready:function(){console.log("APP ready 应该只执行一次")},data:function(){return d.default},methods:{},computed:{showConfigErrorDialog:function(){return this.ddConfigStatus===!1},showCodeErrorDialog:function(){return this.code===!1}}});t.default=p},46:function(e,t){e.exports='<div>\n    <router-view :transition="\'vux-pop-\' + (direction === \'forward\' ? \'in\' : \'out\')">\n\n    </router-view>\n    <alert :show="showConfigErrorDialog" title="发生错误">\n        dd.config配置失败\n    </alert>\n    <alert :show="showCodeErrorDialog" title="发生错误">\n        免登陆code获取失败\n    </alert>\n</div>'},47:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={routerTransition:{forward:"slideRL",back:"slideLR"}};t.default=n},48:function(e,t){},49:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){var n=e.dispatch,o=e.state;callJsApi("runtime.permission.requestAuthCode",{corpId:o.app.ddConfig.corpId||t}).then(function(e){n(c.UPDATE_CODE,e.code),u({dispatch:n,state:o},e.code),console.log("获取到了免登陆code=>"+e.code)}).catch(function(e){n(c.UPDATE_CODE,!1),console.log("获取免登陆code失败")})}function u(e,t){var n=e.dispatch,o=e.state;s.default.get(l.default.API_HOST+"/user/getUserinfo",{params:{code:t,corpId:o.app.ddConfig.corpId,suiteKey:window.getParamByName("suiteKey")},timeout:5e3}).then(function(e){if(200==e.status&&200==e.data.code){var t=e.data.result;n(c.LOGIN_SUCCESS,t)}else n(c.LOGIN_ERROR,!1)}).catch(function(e){n(c.LOGIN_ERROR,!1)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getRequestAuthCode=r,t.getUserInfo=u;var a=n(43),c=i(a),d=n(30),l=o(d),f=n(5),s=o(f)}});
//# sourceMappingURL=web_app.bafd1b89.js.map